<!-- Date: 2025-01-22 -->
<!-- Update Date: 2025-01-22 -->
<!-- File ID: 31184adf-c840-43ad-b86d-caf7bfeef552 -->
<!-- Author: Seoyeon Jang -->

# 개요

쿠버네티스 객체 중 컨트롤러 객체를 배워보자. 컨트롤러 객체는 다른 객체를 다시 추상화한 것이다. 쿠버네티스가 매우 복잡한 시스템이긴 하지만, 이 복잡성이 바로 강력하고 다양한 설정이 가능한 시스템을 만드는
원동력이다.

**파드는 직접 사용하기에는 너무 단순한 객체다.** 파드는 고립된 한 벌의 애플리케이션이며, 각 파드는 서로 다른 노드에 배정된다. 어떤 노드가 고장을 일으킨다면 파드는 유실되며, 쿠버네티스는 유실된 파드를 새
파드로 대체하지 않는다. 억지로 다른 노드에 실행되도록 사람이 직접 관리해야한다면 오케스트레이션 도구를 사용하는 의미가 없다.

컨트롤러 객체가 바로 이런 불편함을 해결해준다. 컨트롤러(controller)객체는 다른 리소스를 관리하는 쿠버네티스 리소스다. 컨트롤러는 쿠버네티스 API와 연동하며 시스템의 현재 상태를 감시하다가 '바람직한
상태'와 차이가 생기면 필요에 따라 그 차이를 바로잡는다. 쿠버네티스에는 여러 가지 컨트롤러 객체가 있다. 그중에서도 파드를 주로 관리하는 컨트롤러 객체는 바로 **디플로이먼트**이다. 앞서 설명했던 파드의 문제점을
디플로이먼트가 모두 해결해준다. 어떤 노드가 고장을 일으켜 파드가 유실되면, 디플로이먼트가 대체 파드를 다른 노드에 실행한다. 디플로이먼트를 스케일링하고 싶다면 필요한 파드 수를 지정하면 된다. 그러면 디플로이먼트가
여러 노드에 걸쳐 필요한 수만큼 파드를 실행한다.

디플로이먼트는 파드를 관리하고 파드는 컨테이너를 관리한다.

![](.2.2_컨트롤러_객체와_함께_파드_실행하기_images/8fb3a8f9.png)

kubectl 을 사용하여 컨테이너를 실행할 이미지와 파드 설정을 지정하면 디플로이먼트를 생성할 수 있다. 쿠버네티스가 디플로이먼트를 생성하면 디플로이먼트가 파드를 생성한다.

> 실습: 조금 전 웹 애플리케이션을 한번 더 실행해보자. 이번에는 디플로이먼트를 사용해서 실행할 것이다.

```shell
$ kubectl create deployment hello-kiamol --image=kiamol/ch02-hello-kiamol
```

![](.2.2_컨트롤러_객체와_함께_파드_실행하기_images/723b04ce.png)
kubectl run 으로 띄운 파드는 NAME 뒤에 아무런 문자열이 붙지 않았었는데, 디플로이먼트로 띄운 파드는 이름 뒤에 무작위 문자열이 붙은 형태로 만들어진다.

중요한 점은, 디플로이먼트는 내가 만들었지만 파드를 직접 만든 적은 없다는 것이다. 디플로이먼트는 쿠버네티스 API를 통해 현재 동작중인 리소스가 무엇이 있는지 살펴보고, 자신이 관리해야할 파드가 없다는 사실을
발견한다. 이후 쿠버네티스 API를 통해 자신에게 필요한 파드를 생성한다. 구체적으로 어떤 과정을 거쳤는가는 중요하지 않다. **디플로이먼트만 만들면 우리에게 필요한 파드를 대신 만들어준다는 점이 중요하다.**

하지만 디플로이먼트가 자산이 관리해야할 리소스를 어떻게 추적하는지를 알아둘 필요가 있다. 이런 패턴은 쿠버네티스 전반에서 매우 많이 쓰인다. 모든 쿠버네티스 리소스는 간단히 키-값 쌍 형태의 레이블을 가지며, 이
레이블을 우리가 원하는 데이터를 담는 데 사용할 수 있다. TODO!!!

# 정리


